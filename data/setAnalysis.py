'''
Created on Apr 22, 2016

@author: jesus

Methods to evaluate how the sentence set generated by the production model resembles the set that is related to each DSS
'''
    
def indicesToWords(indices,indexWordMapping):
    return [indexWordMapping[index] for index in indices]

#precision=correctpredictions/allretrieved
def getPrecision(sizeCorrectPredictionsSet,sizeRetrievedSet):
    if sizeRetrievedSet==0:return 0
    else:
        return sizeCorrectPredictionsSet*1.0/sizeRetrievedSet

#recall=correctpredictions/allexpected
def getRecall(sizeCorrectPredictionsSet,sizeExpectedSet):
    return sizeCorrectPredictionsSet*1.0/sizeExpectedSet

#fscore=2*precision*recall/(precision+recall)
def getFScore(precision,recall):
    if precision+recall==0:return 0
    else:
        return 2.0*(precision*recall)/(precision+recall)
    

def precisionRecallFScore(expectedSet,retrievedSet):
    sizeExpectedSet=len(expectedSet)
    sizeRetrievedSet=len(retrievedSet)
    
    #Find the overlap of the sets (correct predictions)
    copyExpectedSet=expectedSet[:]
    copyRetrievedSet=retrievedSet[:]

    for elem1 in copyExpectedSet[:]:
        for elem2 in copyRetrievedSet:
            if elem1==elem2: 
                copyExpectedSet.remove(elem1)
                copyRetrievedSet.remove(elem2)
    
    correctPredictions=sizeExpectedSet-len(copyExpectedSet)
    
    recall=getRecall(correctPredictions, sizeExpectedSet)
    precision=getPrecision(correctPredictions, sizeRetrievedSet)    
    fscore=getFScore(precision, recall)

    return precision,recall,fscore
     

if __name__ == '__main__':
    
    #set1=[[0, 16, 39, 40, 13, 19, 35, 27, 42], [0, 16, 39, 40, 13, 1, 18, 25, 42], [0, 16, 39, 40, 13, 1, 18, 19, 35, 27, 42], [0, 16, 39, 40, 13, 1, 0, 15, 19, 35, 27, 42], [0, 16, 5, 32, 40, 13, 19, 35, 27, 42], [0, 16, 5, 32, 40, 13, 1, 18, 25, 42], [0, 16, 5, 32, 40, 13, 1, 18, 19, 35, 27, 42], [0, 16, 5, 32, 40, 13, 1, 0, 15, 19, 35, 27, 42]]
    #set2=[[0, 16, 5, 32, 40, 13, 1, 18, 25, 42], [0, 16, 39, 40, 13, 1, 0, 15, 19, 35, 27, 42], [0, 16, 5, 32, 40, 13, 1, 0, 15, 19, 35, 27, 42], [0, 16, 5, 32, 40, 13, 1, 18, 19, 35, 27, 42], [0, 16, 39, 40, 13, 19, 35, 27, 42], [0, 16, 5, 32, 40, 13, 19, 35, 27, 42], [0, 16, 39, 40, 13, 1, 18, 19, 35, 27, 42], [0, 16, 39, 40, 13, 1, 18, 25, 42]]
    
    set1=[[9, 39, 40, 13, 1, 31, 42], [9, 39, 40, 13, 1, 14, 42], [9, 39, 40, 13, 19, 35, 34, 42], [9, 39, 40, 13, 1, 31, 25, 42], [9, 39, 40, 13, 1, 31, 19, 35, 34, 42], [9, 39, 40, 13, 1, 14, 25, 42], [9, 39, 40, 13, 1, 14, 19, 35, 34, 42], [9, 39, 40, 13, 1, 0, 15, 19, 35, 34, 42], [9, 39, 1, 31, 40, 13, 42], [9, 39, 1, 14, 40, 13, 42], [9, 5, 32, 40, 13, 1, 31, 42], [9, 5, 32, 40, 13, 1, 14, 42], [9, 5, 32, 40, 13, 19, 35, 34, 42], [9, 5, 32, 40, 13, 1, 31, 25, 42], [9, 5, 32, 40, 13, 1, 31, 19, 35, 34, 42], [9, 5, 32, 40, 13, 1, 14, 25, 42], [9, 5, 32, 40, 13, 1, 14, 19, 35, 34, 42], [9, 5, 32, 40, 13, 1, 0, 15, 19, 35, 34, 42], [9, 5, 32, 1, 31, 40, 13, 42], [9, 5, 32, 1, 14, 40, 13, 42], [9, 5, 0, 16, 40, 13, 1, 31, 42], [9, 5, 0, 16, 40, 13, 1, 14, 42], [9, 5, 0, 16, 40, 13, 19, 35, 34, 42], [9, 5, 0, 16, 40, 13, 1, 31, 25, 42], [9, 5, 0, 16, 40, 13, 1, 31, 19, 35, 34, 42], [9, 5, 0, 16, 40, 13, 1, 14, 25, 42], [9, 5, 0, 16, 40, 13, 1, 14, 19, 35, 34, 42], [9, 5, 0, 16, 40, 13, 1, 0, 15, 19, 35, 34, 42], [9, 5, 0, 16, 1, 31, 40, 13, 42], [9, 5, 0, 16, 1, 14, 40, 13, 42], [35, 7, 39, 40, 13, 1, 31, 42], [35, 7, 39, 40, 13, 1, 14, 42], [35, 7, 39, 40, 13, 19, 35, 34, 42], [35, 7, 39, 40, 13, 1, 31, 25, 42], [35, 7, 39, 40, 13, 1, 31, 19, 35, 34, 42], [35, 7, 39, 40, 13, 1, 14, 25, 42], [35, 7, 39, 40, 13, 1, 14, 19, 35, 34, 42], [35, 7, 39, 40, 13, 1, 0, 15, 19, 35, 34, 42], [35, 7, 39, 1, 31, 40, 13, 42], [35, 7, 39, 1, 14, 40, 13, 42], [35, 7, 5, 32, 40, 13, 1, 31, 42], [35, 7, 5, 32, 40, 13, 1, 14, 42], [35, 7, 5, 32, 40, 13, 19, 35, 34, 42], [35, 7, 5, 32, 40, 13, 1, 31, 25, 42], [35, 7, 5, 32, 40, 13, 1, 31, 19, 35, 34, 42], [35, 7, 5, 32, 40, 13, 1, 14, 25, 42], [35, 7, 5, 32, 40, 13, 1, 14, 19, 35, 34, 42], [35, 7, 5, 32, 40, 13, 1, 0, 15, 19, 35, 34, 42], [35, 7, 5, 32, 1, 31, 40, 13, 42], [35, 7, 5, 32, 1, 14, 40, 13, 42], [35, 7, 5, 0, 16, 40, 13, 1, 31, 42], [35, 7, 5, 0, 16, 40, 13, 1, 14, 42], [35, 7, 5, 0, 16, 40, 13, 19, 35, 34, 42], [35, 7, 5, 0, 16, 40, 13, 1, 31, 25, 42], [35, 7, 5, 0, 16, 40, 13, 1, 31, 19, 35, 34, 42], [35, 7, 5, 0, 16, 40, 13, 1, 14, 25, 42], [35, 7, 5, 0, 16, 40, 13, 1, 14, 19, 35, 34, 42], [35, 7, 5, 0, 16, 40, 13, 1, 0, 15, 19, 35, 34, 42], [35, 7, 5, 0, 16, 1, 31, 40, 13, 42], [35, 7, 5, 0, 16, 1, 14, 40, 13, 42]]
    set2=[[35, 7, 5, 32, 40, 13, 1, 31, 42], [9, 5, 32, 40, 13, 1, 31, 42], [35, 7, 5, 0, 16, 40, 13, 19, 35, 34, 42], [35, 7, 5, 32, 40, 13, 1, 14, 42], [9, 5, 0, 16, 40, 13, 19, 35, 34, 42], [35, 7, 5, 32, 40, 13, 1, 0, 15, 19, 35, 34, 42], [9, 5, 32, 40, 13, 1, 14, 42], [9, 5, 32, 1, 31, 40, 13, 42], [35, 7, 5, 32, 1, 31, 40, 13, 42], [9, 5, 32, 40, 13, 1, 0, 15, 19, 35, 34, 42], [35, 7, 5, 32, 40, 13, 1, 31, 25, 42], [9, 5, 0, 16, 40, 13, 1, 31, 25, 42], [35, 7, 5, 0, 16, 40, 13, 1, 31, 25, 42], [9, 5, 32, 1, 14, 40, 13, 42], [9, 39, 40, 13, 1, 31, 25, 42], [35, 7, 5, 32, 1, 14, 40, 13, 42], [9, 5, 32, 40, 13, 1, 31, 25, 42], [35, 7, 5, 32, 40, 13, 1, 14, 25, 42], [9, 5, 0, 16, 1, 31, 40, 13, 42], [9, 5, 0, 16, 40, 13, 1, 14, 25, 42], [35, 7, 5, 0, 16, 40, 13, 1, 14, 25, 42], [35, 7, 5, 32, 40, 13, 1, 31, 19, 35, 34, 42], [9, 39, 40, 13, 1, 14, 25, 42], [9, 39, 40, 13, 19, 35, 34, 42], [9, 5, 0, 16, 40, 13, 1, 31, 42], [9, 39, 40, 13, 1, 31, 42], [9, 5, 0, 16, 1, 14, 40, 13, 42], [35, 7, 5, 32, 40, 13, 1, 14, 19, 35, 34, 42], [9, 5, 32, 40, 13, 1, 14, 25, 42], [9, 5, 32, 40, 13, 1, 31, 19, 35, 34, 42], [35, 7, 5, 0, 16, 40, 13, 1, 31, 42], [9, 5, 0, 16, 40, 13, 1, 14, 42], [35, 7, 5, 0, 16, 40, 13, 1, 14, 42], [35, 7, 39, 1, 31, 40, 13, 42], [9, 5, 32, 40, 13, 1, 14, 19, 35, 34, 42], [35, 7, 39, 40, 13, 1, 31, 42], [35, 7, 39, 40, 13, 1, 31, 25, 42], [9, 39, 40, 13, 1, 14, 42], [35, 7, 5, 0, 16, 40, 13, 1, 31, 19, 35, 34, 42], [35, 7, 39, 1, 14, 40, 13, 42], [9, 39, 40, 13, 1, 0, 15, 19, 35, 34, 42], [35, 7, 5, 0, 16, 40, 13, 1, 0, 15, 19, 35, 34, 42], [35, 7, 39, 40, 13, 1, 14, 25, 42], [9, 5, 0, 16, 40, 13, 1, 0, 15, 19, 35, 34, 42], [35, 7, 39, 40, 13, 1, 14, 42], [35, 7, 5, 0, 16, 40, 13, 1, 14, 19, 35, 34, 42], [35, 7, 5, 0, 16, 1, 31, 40, 13, 42], [35, 7, 39, 40, 13, 1, 0, 15, 19, 35, 34, 42], [9, 5, 0, 16, 40, 13, 1, 31, 19, 35, 34, 42], [9, 39, 1, 31, 40, 13, 42], [35, 7, 5, 0, 16, 1, 14, 40, 13, 42], [9, 5, 0, 16, 40, 13, 1, 14, 19, 35, 34, 42], [35, 7, 39, 40, 13, 1, 31, 19, 35, 34, 42], [9, 39, 1, 14, 40, 13, 42], [35, 7, 39, 40, 13, 1, 14, 19, 35, 34, 42], [9, 39, 40, 13, 1, 31, 19, 35, 34, 42], [9, 39, 40, 13, 1, 14, 19, 35, 34, 42]]

    #===========================================================================
    # set1=[[9, 28, 38, 19, 35, 27, 42], [9, 28, 18, 38, 25, 42], [9, 28, 18, 38, 19, 35, 27, 42], [9, 28, 0, 15, 38, 19, 35, 27, 42], [35, 7, 28, 38, 19, 35, 27, 42], [35, 7, 28, 18, 38, 25, 42], [35, 7, 28, 18, 38, 19, 35, 27, 42], [35, 7, 28, 0, 15, 38, 19, 35, 27, 42]]
    # set2=[[35, 7, 28, 38, 19, 35, 27, 42], [9, 28, 0, 15, 38, 19, 35, 27, 42], [9, 28, 18, 38, 25, 42], [35, 7, 28, 0, 15, 38, 19, 35, 27, 42], [35, 7, 28, 18, 38, 19, 35, 27, 42], [9, 28, 38, 19, 35, 27, 42], [9, 28, 18, 38, 19, 35, 27, 42], [35, 7, 28, 18, 38, 25, 42]]
    #===========================================================================

    wordLocalistMapPath='../data/dataFiles/map_localist_words.txt'
    from loadFiles import getWordLocalistMap
    mapIndexWord=getWordLocalistMap(wordLocalistMapPath)
 
    print [indicesToWords(indices,mapIndexWord) for indices in set1]
    print [indicesToWords(indices,mapIndexWord) for indices in set2]
    print len(set1)
    print len(set2)

    precision,recall,fscore=precisionRecallFScore(set1,set2)
    
    print precision
    print recall
    print fscore